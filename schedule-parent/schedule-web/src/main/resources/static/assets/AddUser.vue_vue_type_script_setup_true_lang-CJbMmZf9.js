import{u as M,_ as N}from"./useDialog-Dl2BjXS6.js";import{E as C,T as y}from"./BaseEnum-DZksv6ke.js";import{r as V,o as $,a1 as j,d as z,a as I,g as u,c as J,z as P,w as l,f as e,J as _,u as s,l as U,a2 as S,a3 as G,a4 as H,A}from"./index-DFxeWJFZ.js";import{f as K}from"./index-2NxJnuEc.js";import{u as Q}from"./useInstance-MikN16Nm.js";function W(){const v=V([]),w=async()=>{let i=await j();i&&i.code===200&&(v.value=i.data)},c=(i,b)=>b.label.toLowerCase().indexOf(i.toLowerCase())>=0;return $(()=>{w()}),{filter:c,roleList:v}}const te=z({__name:"AddUser",emits:["save","refresh"],setup(v,{expose:w,emit:c}){const{global:i}=Q(),{roleList:b,filter:D}=W(),{dialog:d,onClose:h,onShow:q}=M();d.height=400,w({show:async(r,t)=>{if(await O(),r==C.ADD)d.title=y.ADD;else{d.title=y.EDIT;let n=await S(t.userId);n&&n.code==200&&i.$objCoppy(n.data,a)}a.type=r,q()}});const a=I({userId:"",roleId:"",type:"",name:"",username:"",password:"",email:"",phone:"",sex:""}),L=I({roleId:[{required:!0,message:"请选择角色",trigger:"blur"}],name:[{required:!0,message:"请输入用户名",trigger:"blur"}],username:[{required:!0,message:"请输入登录名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"}],sex:[{required:!0,message:"请选择性别",trigger:"blur"}]}),{validate:T,resetFields:O,validateInfos:f}=K.useForm(a,L),B=c,E=()=>{T().then(async()=>{let r=null;a.type==C.ADD?r=await G(a):r=await H(a),r&&r.code==200?(A.success(r.msg),B("refresh"),h()):A.error(r.msg)}).catch(()=>{})};return(r,t)=>{const n=u("a-input"),p=u("a-form-item"),m=u("a-col"),g=u("a-row"),x=u("a-radio"),R=u("a-radio-group"),k=u("a-select"),F=u("a-form");return J(),P(N,{title:s(d).title,width:s(d).width,height:s(d).height,visible:s(d).visible,onOnConfirm:E,onOnClose:s(h)},{content:l(()=>[e(F,{style:{"margin-right":"30px"}},{default:l(()=>[e(g,null,{default:l(()=>[e(m,{span:12},{default:l(()=>[e(p,_(s(f).name,{labelCol:{style:"width:80px"},label:"姓名"}),{default:l(()=>[e(n,{value:a.name,"onUpdate:value":t[0]||(t[0]=o=>a.name=o),placeholder:"请输入姓名"},null,8,["value"])]),_:1},16)]),_:1}),e(m,{span:12},{default:l(()=>[e(p,_(s(f).phone,{labelCol:{style:"width:80px"},label:"电话"}),{default:l(()=>[e(n,{value:a.phone,"onUpdate:value":t[1]||(t[1]=o=>a.phone=o),placeholder:"请输入手机号"},null,8,["value"])]),_:1},16)]),_:1})]),_:1}),e(g,null,{default:l(()=>[e(m,{span:12},{default:l(()=>[e(p,{labelCol:{style:"width:80px"},label:"邮箱"},{default:l(()=>[e(n,{value:a.email,"onUpdate:value":t[2]||(t[2]=o=>a.email=o),placeholder:"请输入邮箱"},null,8,["value"])]),_:1})]),_:1}),e(m,{span:12},{default:l(()=>[e(p,_(s(f).sex,{labelCol:{style:"width:80px"},label:"性别"}),{default:l(()=>[e(R,{value:a.sex,"onUpdate:value":t[3]||(t[3]=o=>a.sex=o)},{default:l(()=>[e(x,{value:"0"},{default:l(()=>t[7]||(t[7]=[U("男")])),_:1}),e(x,{value:"1"},{default:l(()=>t[8]||(t[8]=[U("女")])),_:1})]),_:1},8,["value"])]),_:1},16)]),_:1})]),_:1}),e(g,null,{default:l(()=>[e(m,{span:12},{default:l(()=>[e(p,_(s(f).roleId,{labelCol:{style:"width:80px"},label:"角色"}),{default:l(()=>[e(k,{value:a.roleId,"onUpdate:value":t[4]||(t[4]=o=>a.roleId=o),"show-search":"",placeholder:" 请选择角色",style:{width:"100%"},options:s(b),"filter-method":s(D)},null,8,["value","options","filter-method"])]),_:1},16)]),_:1}),e(m,{span:12},{default:l(()=>[e(p,_(s(f).username,{labelCol:{style:"width:80px"},label:"账户"}),{default:l(()=>[e(n,{value:a.username,"onUpdate:value":t[5]||(t[5]=o=>a.username=o),placeholder:"请输入登录账户"},null,8,["value"])]),_:1},16)]),_:1})]),_:1}),e(g,null,{default:l(()=>[e(m,{span:12},{default:l(()=>[e(p,_(s(f).password,{labelCol:{style:"width:80px"},label:"密码"}),{default:l(()=>[e(n,{value:a.password,"onUpdate:value":t[6]||(t[6]=o=>a.password=o),placeholder:"请输入密码"},null,8,["value"])]),_:1},16)]),_:1})]),_:1})]),_:1})]),_:1},8,["title","width","height","visible","onOnClose"])}}});export{te as _};
