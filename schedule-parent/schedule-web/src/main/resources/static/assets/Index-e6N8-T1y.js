import{D as L}from"./BaseEnum-DZksv6ke.js";import{g as P,u as F}from"./schedule-eMs4Cjr4.js";import{i as S,a as H,b as O,F as V}from"./index-DlKmcoY9.js";import{d as B,r as p,a as h,b as r,o as E,c as k,e as T,f as x,w as v,F as G,g as D,u as j,h as n,t as a,i as z,_ as J}from"./index-DFxeWJFZ.js";const q={class:"text-ellipsis"},R={style:{"overflow-y":"auto","overflow-x":"initial"}},K={key:0},Q=B({__name:"Index",setup(U,{expose:b}){const f=p(!1),s=p({id:"",dateTime:"",roomId:"",teacherId:"",courseId:"",beginTime:"",endTime:"",duration:0,courseName:"",teacherName:"",roomName:""}),C=p(!1),M=()=>{C.value=!1},i=p(),N=()=>{i.value.getApi().prev()},y=()=>{i.value.getApi().next()},I=()=>{i.value.getapi().today(),i.value.getApi().getDate()},_=()=>{i.value.getApi().prev()},Y=()=>{i.value.getApi().next()},w=()=>{i.value.getApi().today(),i.value.getApi().getDate},A=o=>{const e=o.event.extendedProps;console.log(e);const t={id:e.id||"",dateTime:e.dateTime||"",roomId:e.roomId||"",teacherId:e.teacherId||"",courseId:e.courseId||"",beginTime:e.beginTime||"",endTime:e.endTime||"",duration:e.duration||0,courseName:e.courseName||"",teacherName:e.teacherName||"",roomName:e.roomName||""};s.value=t,C.value=!0},d=h({id:"",beginTime:"",endTime:"",dateTime:""}),W=async o=>{console.log(o),d.id=o.event.id,d.dateTime=r(o.event.start).format("YYYY-MM-DD"),d.beginTime=r(o.event.start).format("HH:mm:ss"),d.endTime=r(o.event.end).format("HH:mm:ss"),(await F(d)).code==200&&c()},g=h({plugins:[S,H,O],customButtons:{prevWeekCustom:{text:"上周",click:function(){N()}},nextWeekCustom:{text:"下周",click:function(){y()}},tadayCustom:{text:"本周",click:function(){I()}},prevMonthCustom:{text:"上月",click:function(){_()}},nextMonthCustom:{text:"下月",click:function(){Y()}},tbisMonthCustom:{text:"本月",click:function(){w()}}},headerToolbar:{start:"timeGridWeek,prevWeekCustom,todayCustom,nextWeekCustom",right:"dayGridMonth,prevMonthCustom,thisMonthCustom,nextMonthCustom",center:"title"},buttonText:{today:"今天",month:"月视图",week:"周视图",day:"日",list:"周列表"},contentHeight:window.innerHeight-200,initialView:"timeGridWeek",locale:"zh-cn",weekMode:"liquid",firstDay:1,slotMinTime:"08:00",slotMaxTime:"24:00",slotDuration:"00:15",slotLabelFormat:{hour:"numeric",minute:"2-digit",hour12:!1},eventTimeFormat:{hour:"numeric",minute:"2-digit",hour12:!1},events:[],editable:!1,allDaySlot:!1,nowIndicator:!0,handleWindowResize:!0,navLinks:!0,fixedWeekCount:!0,showNonCurrentDates:!1,selectable:!1,selectMirror:!0,dayMaxEvents:!0,weekends:!0,eventClick:A,eventDrop:W,datesSet:o=>{const e=r(o.start).format("YYYY-MM-DD"),t=r(o.end).format("YYYY-MM-DD");m.startDate=e,m.endDate=t,c()}}),m=h({roomIdList:[],courseIdList:[],teacherIdList:[],startDate:r().startOf("month").format("YYYY-MM-DD"),endDate:r().endOf("month").format("YYYY-MM-DD"),beginTime:"",endTime:"",duration:0,delId:"",teacherId:"",roomId:""}),c=async()=>{f.value=!0;try{console.log("发送请求参数:",JSON.stringify(m,null,2));const o=await P(m);if(console.log("接收到响应:",JSON.stringify(o,null,2)),o&&o.code==200){g.events=[];const e=o.data||[];if(console.log("实际数据列表:",e,"数据条数:",e.length),e&&e.length>0){for(let t=0;t<e.length;t++)if(e[t]){let l={id:"",title:"",start:"",end:"",backgroundColor:"",className:"",extendedProps:{}},u=e[t].courseColor,$=e[t].courseColor;l.backgroundColor=u,l.className=$,l.id=e[t].id,l.title=`${e[t].courseName} ${e[t].teacherName} ${e[t].roomName} ${e[t].roomAddress}`,l.start=`${e[t].dateTime} ${e[t].beginTime}`,l.end=`${e[t].dateTime} ${e[t].endTime}`,l.extendedProps=e[t],g.events.push(l)}}}}catch(o){console.error("获取数据失败:",o)}finally{f.value=!1}};return E(()=>{c(),document.title=L.index}),b({getScheduleList:c}),(o,e)=>{const t=D("a-spin"),l=D("a-modal");return k(),T(G,null,[x(t,{spinning:f.value},{default:v(()=>[x(j(V),{ref_key:"fullCalendar",ref:i,class:"demo-app-calendar",options:g},{eventContent:v(u=>[n("div",q,[n("b",null,"《"+a(u.event.extendedProps.courseName)+"》",1),e[0]||(e[0]=n("br",null,null,-1)),n("b",null,a(u.event.extendedProps.teacherName),1),e[1]||(e[1]=n("br",null,null,-1)),n("b",null,a(u.event.extendedProps.roomName),1)])]),_:1},8,["options"])]),_:1},8,["spinning"]),x(l,{visible:C.value,destroyOnClose:"true",onCancel:M},{footer:v(()=>e[2]||(e[2]=[])),default:v(()=>[n("div",R,[e[3]||(e[3]=n("h2",null,"课程信息",-1)),s.value?(k(),T("div",K,[n("p",null,"ID: "+a(s.value.id),1),n("p",null,"课程名称: "+a(s.value.courseName),1),n("p",null,"教师姓名: "+a(s.value.teacherName),1),n("p",null,"日期："+a(s.value.dateTime),1),n("p",null,"开始时间: "+a(s.value.beginTime),1),n("p",null,"结束时间: "+a(s.value.endTime),1),n("p",null,"房间ID: "+a(s.value.roomId),1),n("p",null,"房间名称: "+a(s.value.roomName),1)])):z("",!0)])]),_:1},8,["visible"])],64)}}}),oe=J(Q,[["__scopeId","data-v-30df07f7"]]);export{oe as default};
