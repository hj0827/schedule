import J from"./MergeCourseForm-CzmyxNaA.js";import{u as K,_ as L}from"./useDialog-Dl2BjXS6.js";import{d as P,r as C,a as w,g as i,c as _,z as h,w as l,f as e,J as v,u,e as S,F as G,K as H,l as Q,i as W,b as N,_ as X}from"./index-DFxeWJFZ.js";import{f as Z}from"./index-2NxJnuEc.js";import{E as ee,T as Y}from"./BaseEnum-DZksv6ke.js";import{u as oe}from"./useInstance-MikN16Nm.js";const ae=P({__name:"AddCourse",emits:["save"],setup(le,{expose:F,emit:I}){const g=C([]),x=C([]),T=r=>{g.value.splice(r,1),o.isMergeClasses="0"},k=()=>{o.isMergeClasses="1",t.height=400,g.value.push({courseId:"",courseName:"",majorName:"",courseType:"",courseYear:o.courseYear,courseColor:o.courseColor,type:"",isMergeClasses:""})},o=w({courseId:"",majorName:"",courseName:"",courseType:"",courseYear:"",courseColor:"#ff0000",type:"",isMergeClasses:"0",yuanzhiCourseId:""}),{global:D}=oe(),m=C(),{dialog:t,onShow:j}=K(),A=w({courseName:[{required:!0,message:"请输入课程名称",trigger:"change"}],majorName:[{required:!0,message:"请输入专业名称",trigger:"change"}],courseType:[{required:!0,message:"请输入考期",trigger:"change"}],courseColor:[{required:!0,message:"请选择背景颜色",trigger:"change"}],courseYear:[{required:!0,message:"请选择学年",trigger:"change"}]}),{resetFields:U,validate:q,validateInfos:f}=Z.useForm(o,A),z=I,y=C([]),E=()=>{q().then(async()=>{console.log("父级组件 AddCourse.vue 的数据:"),console.log("addModel:",o);const r=y.value.map(d=>d.getFormData());console.log("mergeForms:",r);const n=[...[{...o}],...r];console.log("合并后的数据:",n),z("save",n),x.value.push({...o}),g.value=[],b()}).catch(r=>{console.error("表单验证失败:",r)})},b=()=>{t.visible=!1,g.value=[],t.height=250},B=()=>{m.value&&(o.courseYear=N(m.value).format("YYYY-MM"))},O=r=>{const a=r.target;o.courseColor=a.value};return F({show:(r,a)=>{U(),r===ee.ADD?(m.value=void 0,t.title=Y.ADD):(t.title=Y.EDIT,D.$objCoppy(a,o),m.value=N(a.courseYear)),o.type=r,j()}}),(r,a)=>{const n=i("a-input"),d=i("a-form-item"),V=i("a-date-picker"),c=i("a-col"),p=i("a-row"),$=i("plus-square-outlined"),R=i("a-form");return _(),h(L,{title:u(t).title,height:u(t).height,visible:u(t).visible,width:u(t).width,onOnClose:b,onOnConfirm:E},{content:l(()=>[e(R,{labelAlign:"right"},{default:l(()=>[e(d,v(u(f).courseName,{labelCol:{style:"width:80px;"},label:"课程名称"}),{default:l(()=>[e(n,{value:o.courseName,"onUpdate:value":a[0]||(a[0]=s=>o.courseName=s),placeholder:"请输入课程名称"},null,8,["value"])]),_:1},16),e(p,null,{default:l(()=>[e(c,{span:12},{default:l(()=>[e(d,v(u(f).courseYear,{labelCol:{style:"width:80px;"},label:"学年"}),{default:l(()=>[e(V,{placeholder:"请选择学年",class:"date-year",value:m.value,"onUpdate:value":a[1]||(a[1]=s=>m.value=s),picker:"month",onOpenChange:B},null,8,["value"])]),_:1},16)]),_:1}),e(c,{span:12},{default:l(()=>[e(d,v(u(f).courseType,{labelCol:{style:"width:80px;"},label:"考期"}),{default:l(()=>[e(n,{value:o.courseType,"onUpdate:value":a[2]||(a[2]=s=>o.courseType=s),placeholder:"请输入考期"},null,8,["value"])]),_:1},16)]),_:1})]),_:1}),e(p,null,{default:l(()=>[e(d,v(u(f).courseColor,{labelCol:{style:"width:80px;"},label:"颜色"}),{default:l(()=>[e(p,{span:12},{default:l(()=>[e(c,{span:6},{default:l(()=>[e(n,{type:"color",value:o.courseColor,"onUpdate:value":a[3]||(a[3]=s=>o.courseColor=s),placeholder:"请输入颜色代码",onInput:O},null,8,["value"])]),_:1}),e(c,{span:18},{default:l(()=>[e(n,{value:o.courseColor,"onUpdate:value":a[4]||(a[4]=s=>o.courseColor=s),placeholder:"请输入颜色代码"},null,8,["value"])]),_:1})]),_:1})]),_:1},16),e(c,{span:12},{default:l(()=>[e(d,v(u(f).majorName,{labelCol:{style:"width:80px;"},label:"专业名称"}),{default:l(()=>[e(n,{value:o.majorName,"onUpdate:value":a[5]||(a[5]=s=>o.majorName=s),placeholder:"请输入专业名称"},null,8,["value"])]),_:1},16)]),_:1})]),_:1}),e(p,null,{default:l(()=>[e(c,{span:24},{default:l(()=>[e(d,{labelCol:{style:"width:80px;"},label:"远智课程ID"},{default:l(()=>[e(n,{value:o.yuanzhiCourseId,"onUpdate:value":a[6]||(a[6]=s=>o.yuanzhiCourseId=s),placeholder:"请输入远智课程ID"},null,8,["value"])]),_:1})]),_:1})]),_:1}),(_(!0),S(G,null,H(g.value,(s,M)=>(_(),h(p,{key:M},{default:l(()=>[e(c,{span:24},{default:l(()=>[e(J,{ref_for:!0,ref_key:"mergeCourseForms",ref:y,courseColor:o.courseColor,courseYear:o.courseYear,onRemove:re=>T(M)},null,8,["courseColor","courseYear","onRemove"])]),_:2},1024)]),_:2},1024))),128)),e(p,null,{default:l(()=>[u(t).title!="编辑"?(_(),h(c,{key:0,span:12},{default:l(()=>[e(d,{class:"icon-merge"},{default:l(()=>[a[8]||(a[8]=Q(" 是否合并： ")),e($,{class:"icon-merge-plus",onClick:k,value:o.isMergeClasses,"onUpdate:value":a[7]||(a[7]=s=>o.isMergeClasses=s)},null,8,["value"])]),_:1})]),_:1})):W("",!0)]),_:1})]),_:1})]),_:1},8,["title","height","visible","width"])}}}),me=X(ae,[["__scopeId","data-v-78a147d2"]]);export{me as default};
